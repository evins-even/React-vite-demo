# 🎨 响应式 rem 工作流程

## 📊 整体架构

```
┌─────────────────────────────────────────────────────────────┐
│                     响应式系统                                │
│                                                               │
│  CSS/Less (写 px)  →  PostCSS (转 rem)  →  浏览器显示        │
│                                                               │
│  JavaScript (动态根字体)  ──────────────────┘                │
└─────────────────────────────────────────────────────────────┘
```

## 🔄 转换流程

### 开发时的完整流程

```
1. 开发者写 CSS
   ↓
   .element { width: 200px; }

2. PostCSS 转换（构建时）
   ↓
   .element { width: 2rem; }  ← 200 ÷ 100 = 2

3. JavaScript 设置根字体（运行时）
   ↓
   根字体 = 100 * (屏幕宽度 / 1920)
   
4. 浏览器计算
   ↓
   1920px 屏幕: 2rem * 100px = 200px
   960px 屏幕:  2rem * 50px = 100px
```

## 🎯 核心配置关系

```
vite.config.js              responsiveConfig.ts
┌──────────────┐           ┌──────────────────┐
│ rootValue    │           │ baseSize         │
│    100       │  ◀─一致─▶ │    100           │
└──────────────┘           └──────────────────┘
       │                            │
       ▼                            ▼
  px → rem 转换              动态调整根字体
  (构建时)                    (运行时)
```

## 📐 尺寸计算示例

```
设计稿: 200px

步骤 1: PostCSS 转换
200px ÷ 100 = 2rem

步骤 2: 根字体计算
根字体 = 100 * (屏幕宽度 / 1920)

步骤 3: 浏览器显示
┌──────────┬──────────┬──────────┐
│ 屏幕宽度  │ 根字体    │ 实际显示  │
├──────────┼──────────┼──────────┤
│ 1920px   │ 100px    │ 200px    │
│ 1440px   │ 75px     │ 150px    │
│ 960px    │ 50px     │ 100px    │
└──────────┴──────────┴──────────┘
```

## 🌊 响应式工作流程

```
页面加载
    ↓
globalFontSize.ts 初始化
    ↓
计算并设置根字体大小
    ↓
浏览器渲染（所有 rem 自动计算）
    ↓
监听窗口变化
    ↓
重新计算根字体（防抖 300ms）
    ↓
浏览器自动重新渲染
```

## 🎨 使用场景决策

```
需要响应式？
    │
    ├─ 是 → 使用小写 px → width: 200px; → 自动转为 2rem
    │
    └─ 否 → 使用大写 PX → width: 200PX; → 保持 200px

特殊情况：
├─ 1px 边框 → border: 1PX solid;
├─ 小图标   → width: 16PX;
└─ 布局/字体 → 使用小写 px（响应式）
```

## 📱 设备适配流程

```
屏幕宽度检测
    │
    ├─ 0-767px    → mobile
    ├─ 768-1023px → tablet
    ├─ 1024-1919px → desktop
    └─ 1920px+    → wide
    │
    ↓
添加 data-device 属性到 <html>
    │
    ↓
CSS 可以针对不同设备应用样式
html[data-device="mobile"] .element { ... }
```

## 💡 核心理念

```
┌─────────────────────────────────────────────────────────┐
│                     一句话总结                            │
│                                                           │
│  写 px → 自动转 rem → 响应式缩放 → 完美适配              │
│                                                           │
│  开发者只需关注设计稿，系统自动处理响应式！               │
└─────────────────────────────────────────────────────────┘
```

## 🔧 配置修改流程

```
需要修改配置
    │
    ├─ 切换预设 → 编辑 responsiveConfig.ts
    │              修改 currentConfig = presetConfigs.xxx
    │              重启项目
    │
    └─ 自定义配置 → 修改 responsiveConfig.ts 中的参数
                    (designWidth, minSize, maxSize 等)
                    重启项目
```

## 📊 性能优化

```
窗口大小变化
    ↓
防抖处理 (300ms)
    ↓
计算新的根字体大小
    ↓
限制最小值/最大值
    ↓
更新 DOM (fontSize + data-device)
    ↓
浏览器自动重新渲染
```

## 🎯 最佳实践

### 开发流程

```
1. 设计阶段
   └─ 确定设计稿宽度 → 设置 designWidth

2. 开发阶段
   └─ 直接按设计稿写 px 值 → 系统自动转换

3. 测试阶段
   └─ 访问 /responsive-test → 调整窗口测试

4. 优化阶段
   └─ 调整 minSize/maxSize → 优化显示效果
```

## 📚 相关文档

- [快速上手](./responsive-setup.md)
- [完整指南](./responsive-guide.md)
- [快速参考](./quick-reference.md)
- [配置说明](./optimization-summary.md)

